(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6066:function(e,t,s){Promise.resolve().then(s.bind(s,5590))},5590:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var a=s(7437),l=s(2265),i=s(9376),n=s(3145),r=s(8771),o=s(5954),c=s(6595),d=s(1239);function h(e){let{timeLeft:t,score:s,combo:l,dashCooldown:i,maxDashCooldown:n=2e3}=e,r=Math.min(100,l/10*100);return(0,a.jsx)("div",{className:"fixed top-0 left-0 right-0 p-4 safe-top z-10",children:(0,a.jsx)("div",{className:"max-w-md mx-auto",children:(0,a.jsxs)("div",{className:"glass rounded-2xl p-4 card-elevated",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center gap-1 mb-1",children:(0,a.jsx)(o.Z,{className:"w-4 h-4 text-white"})}),(0,a.jsxs)("div",{className:"text-2xl font-black text-white",children:[t,"s"]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center gap-1 mb-1",children:(0,a.jsx)(c.Z,{className:"w-4 h-4 text-yellow-300 fill-yellow-300"})}),(0,a.jsx)("div",{className:"text-2xl font-black text-white",children:s})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center gap-1 mb-1",children:(0,a.jsx)(d.Z,{className:"w-4 h-4 text-yellow-300"})}),(0,a.jsxs)("div",{className:"text-2xl font-black text-white",children:["x",l]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"text-xs text-white/70",children:"Combo Meter"}),(0,a.jsxs)("span",{className:"text-xs text-white/70",children:[l,"/10"]})]}),(0,a.jsx)("div",{className:"h-2 bg-white/20 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-red-500 transition-all duration-300",style:{width:"".concat(r,"%")}})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"text-xs text-white/70",children:"Dash Ready"}),(0,a.jsx)("span",{className:"text-xs text-white/70",children:i>0?"".concat((i/1e3).toFixed(1),"s"):"Ready!"})]}),(0,a.jsx)("div",{className:"h-2 bg-white/20 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-purple-400 to-pink-500 transition-all duration-100",style:{width:"".concat(Math.max(0,100-i/n*100),"%")}})})]})]})]})})})}var m=s(2031);function u(e){let{onGameEnd:t,playerColor:s,triggerHaptic:n}=e,o=(0,l.useRef)(null),[c,d]=(0,l.useState)(60),[u,x]=(0,l.useState)(0),[p,g]=(0,l.useState)(1),[f,y]=(0,l.useState)(0);(0,i.useRouter)();let w=(0,l.useRef)({playerX:0,playerY:0,targetX:0,targetY:0,objects:[],score:0,combo:1,comboStreak:0,maxCombo:1,goodBites:0,goldenBites:0,hazardsHit:0,dashesUsed:0,lastDash:0,isDashing:!1,dashCooldown:3e3,stunned:!1,stunnedUntil:0,gameTime:0,lastSpawn:0,isMouseDown:!1,isMunching:!1,munchEndTime:0}),b=(0,l.useCallback)(()=>{let e=Date.now(),t=w.current;if(e-t.lastDash<t.dashCooldown||t.stunned)return;let s=t.targetX-t.playerX,a=t.targetY-t.playerY,l=Math.sqrt(s*s+a*a);l>10&&(t.playerX+=s/l*80,t.playerY+=a/l*80,t.playerX=Math.max(30,Math.min(t.playerX,345)),t.playerY=Math.max(30,Math.min(t.playerY,637)),t.isDashing=!0,t.dashesUsed++,t.lastDash=e,n("medium"),setTimeout(()=>{w.current.isDashing=!1},150))},[n]);return(0,l.useEffect)(()=>{let e;let a=o.current;if(!a)return;let l=a.getContext("2d");if(!l)return;a.width=375,a.height=667;let i=w.current;i.playerX=a.width/2,i.playerY=a.height/2,i.targetX=i.playerX,i.targetY=i.playerY;let c=new Image;c.src="/image copy copy.png";let h=!1;c.onload=()=>{h=!0},c.crossOrigin="anonymous";let u=Date.now(),p=e=>{e.preventDefault(),i.isMouseDown=!0;let t=a.getBoundingClientRect(),s="touches"in e?e.touches[0]:e;i.targetX=(s.clientX-t.left)*(a.width/t.width),i.targetY=(s.clientY-t.top)*(a.height/t.height)},f=e=>{if(!i.isMouseDown)return;e.preventDefault();let t=a.getBoundingClientRect(),s="touches"in e?e.touches[0]:e;i.targetX=(s.clientX-t.left)*(a.width/t.width),i.targetY=(s.clientY-t.top)*(a.height/t.height)},v=e=>{e.preventDefault(),i.isMouseDown=!1},j=e=>{e.preventDefault(),b()};a.addEventListener("pointerdown",p),a.addEventListener("pointermove",f),a.addEventListener("pointerup",v),a.addEventListener("click",j),a.addEventListener("touchstart",p,{passive:!1}),a.addEventListener("touchmove",f,{passive:!1}),a.addEventListener("touchend",v,{passive:!1});let k=()=>{let e,t,s,l,n,o,c,d;let h=i.gameTime,m=Math.random(),u=1+h/60*.5;if(m<.08){e="golden",t=20;let a=r.s_.goldenFoods[Math.floor(Math.random()*r.s_.goldenFoods.length)];s=a.emoji,l=a.color}else if(m<.3+h/120){e="hazard",t=18;let a=r.s_.hazards[Math.floor(Math.random()*Math.min(4,Math.floor(h/12)+1))];s=a.emoji,l=a.color}else{e="good",t=16;let a=r.s_.goodFoods[Math.floor(Math.random()*Math.min(6,Math.floor(h/8)+2))];s=a.emoji,l=a.color}let x=2.5*u,p=1.5*u;switch(Math.floor(4*Math.random())){case 0:n=Math.random()*a.width,o=-40,c=(Math.random()-.5)*p*1.5,d=x+Math.random()*p;break;case 1:n=a.width+40,o=Math.random()*a.height,c=-(x+Math.random()*p),d=(Math.random()-.5)*p*1.5;break;case 2:n=Math.random()*a.width,o=a.height+40,c=(Math.random()-.5)*p*1.5,d=-(x+Math.random()*p);break;default:n=-40,o=Math.random()*a.height,c=x+Math.random()*p,d=(Math.random()-.5)*p*1.5}"hazard"===e?(c*=1.2,d*=1.2):"golden"===e&&(c*=.8,d*=.8),i.objects.push({x:n,y:o,vx:c,vy:d,type:e,size:t,emoji:s,color:l})},N=()=>{let r=Date.now(),o=(r-u)/1e3,p=Math.max(0,60-o);if(i.gameTime=o,d(Math.ceil(p)),y(Math.max(0,i.dashCooldown-(r-i.lastDash))),p<=0){t({score:i.score,goodBites:i.goodBites,goldenBites:i.goldenBites,hazardsHit:i.hazardsHit,maxCombo:i.maxCombo,dashesUsed:i.dashesUsed,survivalTime:60});return}let f=Math.max(400,800-8*o);if(r-i.lastSpawn>f&&(k(),i.lastSpawn=r),i.stunned&&r>i.stunnedUntil&&(i.stunned=!1),i.isMunching&&r>i.munchEndTime&&(i.isMunching=!1),!i.stunned&&i.isMouseDown){let e=i.targetX-i.playerX,t=i.targetY-i.playerY,s=Math.sqrt(e*e+t*t);if(s>3){let a=Math.min(8,.15*s);i.playerX+=e/s*a,i.playerY+=t/s*a}}i.playerX=Math.max(30,Math.min(i.playerX,a.width-30)),i.playerY=Math.max(30,Math.min(i.playerY,a.height-30));let w=l.createLinearGradient(0,0,0,a.height);w.addColorStop(0,"#1e3a8a"),w.addColorStop(.5,"#7c3aed"),w.addColorStop(1,"#c026d3"),l.fillStyle=w,l.fillRect(0,0,a.width,a.height);for(let e=i.objects.length-1;e>=0;e--){let t=i.objects[e];if(t.x+=t.vx,t.y+=t.vy,t.x<-60||t.x>a.width+60||t.y<-60||t.y>a.height+60){i.objects.splice(e,1);continue}let s=t.x-i.playerX,o=t.y-i.playerY;if(Math.sqrt(s*s+o*o)<("golden"===t.type?35:"hazard"===t.type?30:32)&&!i.isDashing){i.objects.splice(e,1),"good"===t.type?(i.goodBites++,i.comboStreak++,i.comboStreak>=5&&(i.combo=Math.min(5,Math.floor(i.comboStreak/5)+1),i.maxCombo=Math.max(i.maxCombo,i.combo)),i.score+=10*i.combo,i.isMunching=!0,i.munchEndTime=r+150,m.l.playMunch(),n("light")):"golden"===t.type?(i.goldenBites++,i.score+=50*i.combo,i.isMunching=!0,i.munchEndTime=r+150,m.l.playMunch(),n("heavy")):"hazard"===t.type&&(i.hazardsHit++,i.comboStreak=0,i.combo=1,i.stunned=!0,i.stunnedUntil=r+500,m.l.playYuck(),n("heavy")),x(i.score),g(i.combo);continue}l.save(),"golden"===t.type&&(l.shadowColor=t.color,l.shadowBlur=12),l.font="".concat(2.2*t.size,"px Arial"),l.textAlign="center",l.textBaseline="middle",l.fillText(t.emoji,t.x,t.y),l.restore()}if(h){let e=(i.isDashing?63.24999999999999:55)*(i.isMunching?1.1:1);l.save(),l.imageSmoothingEnabled=!1,i.stunned?(l.globalAlpha=.5,l.filter="grayscale(100%) brightness(0.8)"):i.isDashing&&(l.shadowColor="#a855f7",l.shadowBlur=25),i.isMunching&&(l.shadowColor="#fbbf24",l.shadowBlur=15),l.drawImage(c,i.playerX-e/2,i.playerY-e/2,e,e),l.restore()}else l.beginPath(),l.arc(i.playerX,i.playerY,i.isDashing?30:25,0,2*Math.PI),l.fillStyle=i.stunned?"#gray":i.isDashing?"#a855f7":s,l.fill(),l.strokeStyle="white",l.lineWidth=3,l.stroke();e=requestAnimationFrame(N)};return N(),()=>{cancelAnimationFrame(e),a.removeEventListener("pointerdown",p),a.removeEventListener("pointermove",f),a.removeEventListener("pointerup",v),a.removeEventListener("click",j),a.removeEventListener("touchstart",p),a.removeEventListener("touchmove",f),a.removeEventListener("touchend",v)}},[t,s,n,b]),(0,a.jsxs)("div",{className:"relative w-full h-full",children:[(0,a.jsx)(h,{timeLeft:c,score:u,combo:p,dashCooldown:f}),(0,a.jsx)("canvas",{ref:o,className:"w-full h-full touch-none",style:{touchAction:"none"}}),(0,a.jsx)("div",{className:"fixed bottom-24 left-0 right-0 text-center z-10 pointer-events-none",children:(0,a.jsx)("div",{className:"glass px-6 py-3 rounded-full inline-block card-elevated",children:(0,a.jsx)("p",{className:"text-white font-medium",children:"Hold to move • Tap to dash"})})})]})}var x=s(4681),p=s(9474),g=s(2023),f=s(3276),y=s(9637);function w(){let e=(0,i.useRouter)(),{state:t,cosmetics:s,updateScore:r,updateChallengeProgress:o,completeChallenge:c,challenges:h,triggerHaptic:m,isLoaded:w}=(0,x.g)(),[b,v]=(0,l.useState)("menu"),[j,k]=(0,l.useState)(null),[N,S]=(0,l.useState)({crumbs:0,challengeRewards:0}),M=x.w.find(e=>e.id===t.selectedSkin),C=(null==M?void 0:M.color)||"#3b82f6";return w?"results"===b&&j?(0,a.jsx)("div",{className:"min-h-screen p-4 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"max-w-md w-full glass rounded-3xl p-8 card-elevated",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)(p.Z,{className:"w-16 h-16 text-yellow-500 mx-auto mb-3"}),(0,a.jsx)("h2",{className:"text-5xl font-black text-white mb-2 animate-pop",children:j.score}),(0,a.jsx)("p",{className:"text-white/80 text-lg",children:"Final Score"}),j.score>t.bestScore&&(0,a.jsx)("p",{className:"text-base font-bold text-yellow-300 mt-2",children:"\uD83C\uDF89 NEW BEST SCORE!"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[(0,a.jsxs)("div",{className:"bg-white/20 rounded-2xl p-4 text-center",children:[(0,a.jsx)(g.Z,{className:"w-6 h-6 text-yellow-300 mx-auto mb-2"}),(0,a.jsxs)("div",{className:"text-2xl font-black text-white",children:["+",N.crumbs+N.challengeRewards]}),(0,a.jsx)("div",{className:"text-sm text-white/70",children:"Crumbs"})]}),(0,a.jsxs)("div",{className:"bg-white/20 rounded-2xl p-4 text-center",children:[(0,a.jsx)(d.Z,{className:"w-6 h-6 text-yellow-300 mx-auto mb-2"}),(0,a.jsxs)("div",{className:"text-2xl font-black text-white",children:["x",j.maxCombo]}),(0,a.jsx)("div",{className:"text-sm text-white/70",children:"Max Combo"})]})]}),(0,a.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-white/80",children:"Good Bites"}),(0,a.jsx)("span",{className:"font-bold text-white text-lg",children:j.goodBites})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-white/80",children:"Golden Bites"}),(0,a.jsx)("span",{className:"font-bold text-white text-lg",children:j.goldenBites})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-white/80",children:"Hazards Hit"}),(0,a.jsx)("span",{className:"font-bold text-white text-lg",children:j.hazardsHit})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-white/80",children:"Dashes Used"}),(0,a.jsx)("span",{className:"font-bold text-white text-lg",children:j.dashesUsed})]})]}),N.challengeRewards>0&&(0,a.jsx)("div",{className:"bg-white/20 border-2 border-yellow-300 rounded-2xl p-4 mb-6",children:(0,a.jsxs)("p",{className:"text-base font-bold text-yellow-300 text-center",children:["\uD83C\uDFC6 Challenge bonus: +",N.challengeRewards," Crumbs!"]})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>{v("playing"),k(null)},className:"w-full bg-white text-red-600 font-black text-xl py-5 rounded-2xl hover:bg-white/95 active:scale-95 transition-all flex items-center justify-center gap-2 card-elevated",children:[(0,a.jsx)(f.Z,{className:"w-6 h-6"}),"Play Again"]}),(0,a.jsxs)("button",{onClick:()=>e.push("/"),className:"w-full bg-white/20 text-white font-bold text-base py-4 rounded-2xl hover:bg-white/25 active:scale-95 transition-all flex items-center justify-center gap-2",children:[(0,a.jsx)(y.Z,{className:"w-5 h-5"}),"Home"]})]})]})}):"playing"===b?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(u,{onGameEnd:e=>{console.log("[Analytics] run_started",{score:e.score});let{crumbsEarned:s}=r(e.score),a=0;h.forEach(e=>{if(e.completed&&!t.completedChallenges.includes(e.id)){let t=c(e.id);a+=t}}),h.forEach(t=>{switch(t.id.split("_")[0]){case"score":e.score>=t.target&&o(t.id,e.score);break;case"collect":o(t.id,e.goodBites);break;case"combo":o(t.id,e.maxCombo);break;case"golden":o(t.id,e.goldenBites);break;case"perfect":0===e.hazardsHit&&o(t.id,1);break;case"dash":o(t.id,e.dashesUsed);break;case"play":o(t.id,1);break;case"survive":o(t.id,Math.floor(e.survivalTime))}}),k(e),S({crumbs:s,challengeRewards:a}),v("results")},playerColor:C,triggerHaptic:m})}):(0,a.jsx)("div",{className:"min-h-screen p-6 flex items-center justify-center safe-top",children:(0,a.jsxs)("div",{className:"max-w-md w-full glass rounded-3xl p-8 card-elevated text-center",children:[(0,a.jsx)("div",{className:"mb-4 flex justify-center",children:(0,a.jsx)("div",{className:"relative w-32 h-32",children:(0,a.jsx)(n.default,{src:"/santa_pockets.png",alt:"Santa Pockets the Raccoon",fill:!0,className:"object-contain drop-shadow-2xl",priority:!0})})}),(0,a.jsx)("h1",{className:"text-4xl font-black text-white mb-2",children:"Arcade Mode"}),(0,a.jsx)("p",{className:"text-white/80 text-lg mb-2",children:"60 Second Sprint"}),(0,a.jsx)("p",{className:"text-white/60 text-sm mb-8",children:"Help Pockets collect treats!"}),(0,a.jsxs)("div",{className:"bg-white/10 rounded-2xl p-6 mb-8",children:[(0,a.jsx)("h2",{className:"font-bold text-white text-lg mb-4",children:"How to Play:"}),(0,a.jsxs)("ul",{className:"text-left text-base text-white/90 space-y-3",children:[(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"\uD83C\uDFAF"}),(0,a.jsx)("span",{children:"Hold screen to move Pockets"})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"⚡"}),(0,a.jsx)("span",{children:"Tap to dash through obstacles"})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"\uD83C\uDF70"}),(0,a.jsx)("span",{children:"Collect desserts for points"})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"⭐"}),(0,a.jsx)("span",{children:"Grab golden stars for bonus points"})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"\uD83C\uDFCF"}),(0,a.jsx)("span",{children:"Avoid non-food items like bats & socks"})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDD25"}),(0,a.jsx)("span",{children:"Build combos for multipliers"})]})]})]}),(0,a.jsx)("button",{onClick:()=>{v("playing"),console.log("[Analytics] run_started")},className:"w-full bg-white text-red-600 font-black text-2xl py-6 rounded-2xl hover:bg-white/95 active:scale-95 transition-all mb-4 card-elevated",children:"START GAME"}),(0,a.jsx)("button",{onClick:()=>e.push("/"),className:"text-white/80 hover:text-white font-medium text-base",children:"Back to Home"})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-white/30 border-t-white"})})}},4681:function(e,t,s){"use strict";s.d(t,{g:function(){return o},w:function(){return n}});var a=s(2265);let l="feastfun_game_state",i={bestScore:0,crumbs:0,ownedCosmetics:["default_skin","default_trail"],selectedSkin:"default_skin",selectedTrail:"default_trail",selectedEmote:"",completedChallenges:[],dailyStreak:0,lastPlayedDate:"",soundEnabled:!0,hapticsEnabled:!0,totalRuns:0,totalScore:0},n=[{id:"default_skin",name:"Classic",type:"skin",cost:0,color:"#3b82f6",description:"The OG"},{id:"fire_skin",name:"Firecracker",type:"skin",cost:500,color:"#ef4444",description:"Blazing hot"},{id:"ice_skin",name:"Frosty",type:"skin",cost:500,color:"#06b6d4",description:"Cool as ice"},{id:"gold_skin",name:"Golden",type:"skin",cost:1e3,color:"#fbbf24",description:"For winners"},{id:"neon_skin",name:"Neon",type:"skin",cost:1500,color:"#a855f7",description:"Glow up"},{id:"default_trail",name:"Basic Trail",type:"trail",cost:0,description:"Standard trail"},{id:"star_trail",name:"Starlight",type:"trail",cost:300,description:"Leave stars behind"},{id:"rainbow_trail",name:"Rainbow",type:"trail",cost:800,description:"Colorful path"},{id:"wave_emote",name:"Wave",type:"emote",cost:200,description:"\uD83D\uDC4B"},{id:"fire_emote",name:"On Fire",type:"emote",cost:400,description:"\uD83D\uDD25"}],r=[{id:"score_1000",name:"Score 1000",description:"Score 1000+ points in a run",type:"daily",target:1e3,reward:100},{id:"score_2000",name:"Score 2000",description:"Score 2000+ points in a run",type:"daily",target:2e3,reward:200},{id:"collect_20",name:"Bite Collector",description:"Collect 20 Good Bites in one run",type:"daily",target:20,reward:150},{id:"combo_5",name:"Combo Master",description:"Reach a 5x combo multiplier",type:"daily",target:5,reward:100},{id:"golden_3",name:"Golden Hunter",description:"Collect 3 Golden Bites in one run",type:"daily",target:3,reward:200},{id:"perfect_run",name:"Perfect Run",description:"Complete a run without hitting hazards",type:"daily",target:1,reward:300},{id:"dash_10",name:"Dash Master",description:"Use dash 10 times in one run",type:"daily",target:10,reward:100},{id:"play_3",name:"Daily Grind",description:"Complete 3 runs today",type:"daily",target:3,reward:150},{id:"survive_45",name:"Survivor",description:"Survive for 45+ seconds",type:"daily",target:45,reward:100},{id:"speed_demon",name:"Speed Demon",description:"Collect 30 bites in 30 seconds",type:"daily",target:30,reward:250},{id:"week_score_10k",name:"Weekly Warrior",description:"Score 10,000+ total points this week",type:"weekly",target:1e4,reward:500},{id:"week_runs_15",name:"Dedication",description:"Complete 15 runs this week",type:"weekly",target:15,reward:400},{id:"week_streak_5",name:"Streak Master",description:"Maintain a 5-day streak",type:"weekly",target:5,reward:600},{id:"week_golden_15",name:"Golden Week",description:"Collect 15 Golden Bites this week",type:"weekly",target:15,reward:700},{id:"week_perfect_3",name:"Perfectionist",description:"Complete 3 perfect runs this week",type:"weekly",target:3,reward:800}];function o(){let[e,t]=(0,a.useState)(i),[s,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(!1),h=()=>{let e=new Date().toISOString().split("T")[0],t=new Date().getDay(),s=new Date;s.setDate(s.getDate()+(0===t?-6:1-t));let a=s.toISOString().split("T")[0],l=r.filter(e=>"daily"===e.type),i=r.filter(e=>"weekly"===e.type),n=parseInt(e.replace(/-/g,""))%l.length;o([...[l[n%l.length],l[(n+1)%l.length],l[(n+2)%l.length]].map(t=>({...t,id:"".concat(t.id,"_").concat(e),type:"daily",progress:0,completed:!1})),...i.map(e=>({...e,id:"".concat(e.id,"_").concat(a),type:"weekly",progress:0,completed:!1}))])};return(0,a.useEffect)(()=>{(()=>{console.log("[GameStore] Initializing...");try{{let e=localStorage.getItem(l);e&&(t(JSON.parse(e)),console.log("[GameStore] State loaded from localStorage"))}}catch(e){console.error("Failed to load game state:",e)}h(),console.log("[GameStore] Loaded successfully"),d(!0)})()},[]),(0,a.useEffect)(()=>{if(c)try{localStorage.setItem(l,JSON.stringify(e))}catch(e){console.error("Failed to save game state:",e)}},[e,c]),{state:e,challenges:s,cosmetics:n,updateScore:s=>{let a=Math.floor(s/200),l=new Date().toISOString().split("T")[0],i=e.dailyStreak;if(e.lastPlayedDate!==l){let t=new Date;t.setDate(t.getDate()-1);let s=t.toISOString().split("T")[0];i=e.lastPlayedDate===s?e.dailyStreak+1:1}return console.log("[Analytics] run_ended",{score:s,crumbsEarned:a,streak:i}),t(e=>({...e,bestScore:Math.max(e.bestScore,s),crumbs:e.crumbs+a,dailyStreak:i,lastPlayedDate:l,totalRuns:e.totalRuns+1,totalScore:e.totalScore+s})),{crumbsEarned:a,newStreak:i}},purchaseCosmetic:s=>{let a=n.find(e=>e.id===s);return!(!a||e.crumbs<a.cost||e.ownedCosmetics.includes(s))&&(console.log("[Analytics] cosmetic_purchased",{cosmeticId:s,cost:a.cost}),t(e=>({...e,crumbs:e.crumbs-a.cost,ownedCosmetics:[...e.ownedCosmetics,s]})),!0)},selectCosmetic:(s,a)=>{e.ownedCosmetics.includes(s)&&("skin"===a?t(e=>({...e,selectedSkin:s})):"trail"===a?t(e=>({...e,selectedTrail:s})):"emote"===a&&t(e=>({...e,selectedEmote:s})))},completeChallenge:a=>{let l=s.find(e=>e.id===a);return!l||e.completedChallenges.includes(a)?0:(console.log("[Analytics] challenge_completed",{challengeId:a,reward:l.reward}),t(e=>({...e,crumbs:e.crumbs+l.reward,completedChallenges:[...e.completedChallenges,a]})),l.reward)},updateChallengeProgress:(t,s)=>{o(a=>a.map(a=>a.id!==t||e.completedChallenges.includes(t)?a:{...a,progress:Math.max(a.progress,s),completed:s>=a.target}))},toggleSound:()=>{t(e=>({...e,soundEnabled:!e.soundEnabled}))},toggleHaptics:()=>{t(e=>({...e,hapticsEnabled:!e.hapticsEnabled}))},resetData:()=>{console.log("[Analytics] data_reset"),t(i),o([]),h()},triggerHaptic:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";e.hapticsEnabled&&"vibrate"in navigator&&navigator.vibrate({light:10,medium:20,heavy:50}[t])},isLoaded:c}}},9637:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},3276:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},5954:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]])}},function(e){e.O(0,[847,207,971,117,744],function(){return e(e.s=6066)}),_N_E=e.O()}]);